<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes" ?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="yes" ?>
<?rfc strict="no" ?>
<?rfc rfcedstyle="yes" ?>
<?rfc subcompact="no" ?>
<rfc ipr="trust200902" category="info" docName="draft-handte-hybi-zstd-pcme-latest">
  <front>
    <title abbrev="Zstd PCME">
      A Zstandard Per-Message Compression Extension for WebSocket
    </title>
    <author initials="W. F. P." surname="Handte" fullname="W. Felix P. Handte">
      <organization>Facebook, Inc.</organization>
      <address>
        <postal>
          <street>770 Broadway</street>
          <city>New York</city>
          <region>NY</region>
          <code>10003</code>
          <country>US</country>
        </postal>
        <email>w@felixhandte.com</email>
      </address>
    </author>
    <author initials="F" surname="Gasper" fullname="Felipe Gasper">
      <organization>[TODO]</organization>
      <address>
        <postal>
          <street>[TODO]</street>
          <city>[TODO]</city>
          <region>[TODO]</region>
          <code>[TODO]</code>
          <country>[TODO]</country>
        </postal>
        <email>felipe@felipegasper.com</email>
      </address>
    </author>
    <date/>
    <area>ART</area>
    <workgroup>Individual submission</workgroup>
    <keyword>Compression</keyword>
    <keyword>WebSocket</keyword>
    <abstract>
      <t>
        This document defines a Per-Message Compression Extension <xref target="RFC7692"/> for the WebSocket Protocol <xref target="RFC6455"/> based on the Zstandard compression format <xref target="RFC8478"/>.
      </t>
      <t>
        [TODO]
      </t>
    </abstract>
    <note title="Draft Development">
      <t>
        [RFC Editor: Please remove this section before publication.]
      </t>
      <t>
        The source code and issues list for this draft can be found at https://github.com/felixhandte/draft-handte-hybi-zstd-pcme.
      </t>
      <t>
        Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at https://lists.w3.org/Archives/Public/ietf-http-wg/.
      </t>
    </note>
  </front>

  <middle>
    <section anchor="intro" title="Introduction">
      <t>
        This document defines a Per-Message Compression Extension <xref target="RFC7692"/> for the WebSocket Protocol <xref target="RFC6455"/> based on the Zstandard compression format <xref target="RFC8478"/>.
      </t>
      <t>
        This extension is modeled on the "permessage-deflate" extension defined in <xref target="RFC7692"/>. It attempts as much as possible to present a compatible interface to its users, differing only internally (primarily in the use of a different underlying compression scheme and then how it maps the same options as the "permessage-deflate" extension to the configuration of Zstandard).
      </t>
    </section>

    <section anchor="defs" title="Definitions">
      <section anchor="defs-reqs" title="Requirements">
        <t>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119].
        </t>
      </section>

      <section anchor="defs-ws" title="WebSocket Terminology">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="defs-zstd" title="Zstandard Definitions">
        <t>
          [TODO]
        </t>
      </section>
    </section>

    <section anchor="extension-params" title="Extension Parameters">
      <t>
        [TODO]
      </t>

      <section anchor="extension-param-server-no-context-takeover" title="&quot;server_no_context_takeover&quot;">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="extension-param-client-no-context-takeover" title="&quot;client_no_context_takeover&quot;">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="extension-param-server-max-window-bits" title="&quot;server_max_window_bits&quot;">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="extension-param-client-max-window-bits" title="&quot;client_max_window_bits&quot;">
        <t>
          [TODO]
        </t>
      </section>
    </section>

    <section anchor="transformation" title="Message Payload Transformation">
      <section anchor="compression" title="Compression">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="decompression" title="Decompression">
        <t>
          [TODO]
        </t>
      </section>
    </section>

    <section anchor="iana" title="IANA Considerations">
      <section anchor="iana-websocket-extension-registry" title="WebSocket Extension Name">
        <t>
          IANA is requested to register the following WebSocket extension name in the "WebSocket Extension Name Registry" defined in <xref target="RFC6455"/>.
        </t>
        <t>
          <list style="hanging">
            <t hangText="Extension Identifier:">
              permessage-zstd
            </t>
            <t hangText="Extension Common Name:">
              WebSocket Per-Message Compression using Zstandard
            </t>
            <t hangText="Extension Definition:">
              This document
            </t>
            <t hangText="Known Incompatible Extensions:">
              None
            </t>
          </list>
        </t>
        <t>
          The "permessage-zstd" extension name is used in the "Sec-WebSocket-Extensions" header in the WebSocket opening handshake to negotiate use of the "permessage-zstd" extension.
        </t>
      </section>
    </section>

    <section anchor="security" title="Security Considerations">
      <t>
        [TODO]
      </t>
    </section>

    <section anchor="future-work" title="Future Work">
      <t>
        [TODO]
      </t>

      <section anchor="future-work-independent-negotiation" title="Independent Negotiation for Each Direction">
        <t>
          [TODO]
        </t>
      </section>

      <section anchor="future-work-dictionaries" title="Dictionaries">
        <t>
          [TODO]
        </t>
      </section>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119">
        <front>
          <title>Key words for use in RFCs to Indicate Requirement Levels</title>
          <author initials="S." surname="Bradner" fullname="Scott Bradner">
            <organization>Harvard University</organization>
          </author>
          <date year="1997" month="March"/>
          <abstract>
            <t>
              In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.
            </t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="2119"/>
        <seriesInfo name="DOI" value="10.17487/RFC2119"/>
      </reference>
      <reference anchor="RFC6455" target="https://www.rfc-editor.org/info/rfc6455">
        <front>
          <title>The WebSocket Protocol</title>
          <author initials="I." surname="Fette" fullname="I. Fette">
            <organization>Google, Inc.</organization>
          </author>
          <author initials="A." surname="Melnikov" fullname="A. Melnikov">
          <organization>Isode Ltd.</organization>
          </author>
          <date year="2011" month="December"/>
          <abstract>
            <t>
              The WebSocket Protocol enables two-way communication between a client running untrusted code in a controlled environment to a remote host that has opted-in to communications from that code. The security model used for this is the origin-based security model commonly used by web browsers. The protocol consists of an opening handshake followed by basic message framing, layered over TCP. The goal of this technology is to provide a mechanism for browser-based applications that need two-way communication with servers that does not rely on opening multiple HTTP connections (e.g., using XMLHttpRequest or &lt;iframe&gt;s and long polling).
            </t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="6455"/>
        <seriesInfo name="DOI" value="10.17487/RFC6455"/>
      </reference>
      <reference anchor="RFC7692" target="https://www.rfc-editor.org/info/rfc7692">
        <front>
          <title>Compression Extensions for WebSocket</title>
          <author initials="T." surname="Yoshino" fullname="T. Yoshino">
            <organization>Google, Inc.</organization>
          </author>
          <date year="2015" month="December"/>
          <abstract>
            <t>
              This document defines a framework for creating WebSocket extensions that add compression functionality to the WebSocket Protocol. An extension based on this framework compresses the payload data portion of WebSocket data messages on a per-message basis using parameters negotiated during the opening handshake. This framework provides a general method for applying a compression algorithm to the contents of WebSocket messages. Each compression algorithm has to be defined in a document defining the extension by specifying the parameter negotiation and the payload transformation algorithm in detail. This document also specifies one specific compression extension using the DEFLATE algorithm.
            </t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="7692"/>
        <seriesInfo name="DOI" value="10.17487/RFC7692"/>
      </reference>
      <reference anchor="RFC8478" target="https://www.rfc-editor.org/info/rfc8478">
        <front>
          <title>Zstandard Compression and the application/zstd Media Type</title>
          <author initials="Y." surname="Collet" fullname="Y. Collet">
            <organization>Facebook, Inc.</organization>
          </author>
          <author initials="M." surname="Kucherawy" fullname="M. Kucherawy" role="editor">
            <organization>Facebook, Inc.</organization>
          </author>
          <date year="2018" month="October"/>
          <abstract>
            <t>
              Zstandard, or "zstd" (pronounced "zee standard"), is a data compression mechanism. This document describes the mechanism and registers a media type and content encoding to be used when transporting zstd-compressed content via Multipurpose Internet Mail Extensions (MIME).
            </t>
            <t>
              Despite use of the word "standard" as part of its name, readers are advised that this document is not an Internet Standards Track specification; it is being published for informational purposes only.
            </t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8478"/>
        <seriesInfo name="DOI" value="10.17487/RFC8478"/>
      </reference>
    </references>

    <references title="Informative References">
      <reference anchor="CRIME" target="https://www.ekoparty.org/archive/2012/CRIME_ekoparty2012.pdf">
        <front>
          <title>Compression Ratio Info-leak Made Easy</title>
          <author initials="J." surname="Rizzo" fullname="Juliano Rizzo"></author>
          <author initials="T." surname="Duong" fullname="Thai Duong"></author>
          <date year="2012"/>
        </front>
      </reference>
    </references>
  </back>
</rfc>
